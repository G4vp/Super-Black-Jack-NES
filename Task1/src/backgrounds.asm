.include "constants.inc"
.include "header.inc"


.segment "CODE"
.proc irq_handler
  RTI
.endproc

.proc nmi_handler
  LDA #$00
  STA OAMADDR
  LDA #$02
  STA OAMDMA
	LDA #$00
	STA $2005
	STA $2005


  RTI
.endproc

.import reset_handler

.export main
.proc main
;   ; write a palette
  LDX PPUSTATUS
  LDX #$3f
  STX PPUADDR
  LDX #$00
  STX PPUADDR
;   LDA #$29
;   STA PPUDATA
;   LDA #$19
;   STA PPUDATA
;   LDA #$09
;   STA PPUDATA
;   LDA #$0f
;   STA PPUDATA

LDX #$00

load_palettes:
  LDA palettes,X
  STA PPUDATA
  INX
  CPX #$20
  BNE load_palettes


JSR load_background_graphics ;;CALLING THE SUBROUTINE
JSR draw_sprite_cards



	; finally, attribute table
	; LDA PPUSTATUS
	; LDA #$23
	; STA PPUADDR
	; LDA #$c9
	; STA PPUADDR
	; LDA #%00000000
	; STA PPUDATA

	; LDA PPUSTATUS
	; LDA #$23
	; STA PPUADDR
	; LDA #$e0
	; STA PPUADDR
	; LDA #%00000000
	; STA PPUDATA



vblankwait:       ; wait for another vblank before continuing
  BIT PPUSTATUS
  BPL vblankwait

  LDA #%10010000  ; turn on NMIs, sprites use first pattern table
  STA PPUCTRL
  LDA #%00011110  ; turn on screen
  STA PPUMASK

  
forever:
  JMP forever
.endproc

;Subroutine for background graphics 
.proc load_background_graphics

	load_background:
	LDA PPUSTATUS
	LDA #$20
	STA PPUADDR
	LDA #$00
	STA PPUADDR
	LDX #$00

	Loop1: 
	LDA background, X   ;starts at Zero, and loads the first element
	STA PPUDATA       
	INX					; increses x
	CPX #$FF
	BNE Loop1

	Loop2: 
	LDA background1, X   
	STA PPUDATA      
	INX
	CPX #$FF
	BNE Loop2

	Loop3: 
	LDA background2, X  
	STA PPUDATA       
	INX
	CPX #$FF
	BNE Loop3

	Loop4: 
	LDA background3, X   
	STA PPUDATA       
	INX
	CPX #$FF
	BNE Loop4

	LDX #$00

	RTS

.endproc

.proc draw_sprite_cards
 LDX #$00
load_sprites: 
  LDA sprites,X
  STA $0200,X
  INX
  CPX #$C0
  BNE load_sprites

RTS
.endproc


.segment "VECTORS"
.addr nmi_handler, reset_handler, irq_handler

.segment "RODATA"
palettes: ;check if this is right
.byte $19, $0f, $21, $32 ; s
.byte $19, $0f, $21, $32 ; b
.byte $19, $0f, $21, $32  ;b
.byte $19, $0f, $21, $32  ;b

.byte $19, $0C, $16, $38 ;back
.byte $19, $0C, $16, $38 ;s
.byte $19, $32, $16, $38 ;s n
.byte $19, $0f, $32, $38

sprites: 
;pc
.byte $20, $0F, $06, $3A ;red
.byte $28, $12, $06, $3A

.byte $20, $05, $06, $52 ;red
.byte $28, $13, $06, $52

.byte $20, $06, $07, $6E ;black
.byte $28, $14, $07, $6E

.byte $20, $0D, $06, $82 ;red
.byte $28, $15, $06, $82

.byte $20, $08, $07, $9E ;red
.byte $28, $12, $07, $9E

.byte $20, $09, $07, $B6 ;red
.byte $28, $13, $07, $B6

.byte $20, $0A, $07, $CE ;red
.byte $28, $14, $07, $CE

.byte $40, $0B, $07, $3E ;black
.byte $48, $12, $07, $3E

.byte $40, $0C, $06, $52 ;black
.byte $48, $15, $06, $52

;player
.byte $90, $10, $07, $26 ;red
.byte $98, $12, $07, $26

.byte $90, $05, $06, $3A ;red
.byte $98, $12, $06, $3A

.byte $90, $11, $06, $52 ;red
.byte $98, $14, $06, $52

.byte $90, $07, $06, $6A ;red
.byte $98, $15, $06, $6A

.byte $90, $08, $06, $82 ;red
.byte $98, $12, $06, $82

.byte $90, $09, $07, $9E ;red
.byte $98, $13, $07, $9E

.byte $90, $0C, $07, $B6 ;red
.byte $98, $15, $07, $B6

.byte $90, $0B, $07, $CE ;red
.byte $98, $14, $07, $CE

.byte $B0, $0D, $07, $3E ;black
.byte $B8, $13, $07, $3E

.byte $B0, $0E, $06, $52 ;black
.byte $B8, $12, $06, $52

;CASH

.byte $6E, $16, $05, $C8 ;black
.byte $6E, $1A, $05, $D0
.byte $6E, $1C, $05, $D8 ;black

.byte $77, $1D, $05, $C8 ;black
.byte $77, $1F, $05, $D0
.byte $77, $1F, $05, $D8 ;black

.byte $77, $16, $05, $48 ;black
.byte $77, $1E, $05, $50

.byte $08, $17, $05, $28 ;black
.byte $08, $1D, $05, $30

;WIN





background:
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$23,$16,$2e,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10
	.byte $10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$0a,$0b,$00,$04,$05,$00,$04,$05,$00,$04,$05,$00
	.byte $04,$05,$00,$04,$05,$00,$04,$05,$00,$04,$05,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$0c,$0d,$00,$06,$07,$00,$06,$07,$00,$06,$07,$00
	.byte $06,$07,$00,$06,$07,$00,$06,$07,$00,$06,$07,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$34,$0e,$0f,$00,$08,$09,$31,$08,$09,$00,$08,$09,$00
	.byte $08,$09,$00,$08,$09,$00,$08,$09,$00,$08,$09,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$44,$45,$00,$00,$00,$00,$41,$00,$00,$00,$00,$00,$00
	.byte $42,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00

background1:
	.byte $00,$00,$12,$00,$00,$00,$00,$04,$05,$00,$04,$05,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$06,$07,$00,$06,$07,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$31,$08,$09,$00,$08,$09,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11
	.byte $11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$16,$14,$26,$1b,$2e,$2f,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$23,$1f,$14,$2c,$18,$25,$2e,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$15,$1c,$17,$2e,$2f,$00,$00,$00,$00,$00,$00,$00

background2:
	.byte $00,$00,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10
	.byte $10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$10,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$04,$05,$00,$04,$05,$00,$04,$05,$00,$04,$05,$00
	.byte $04,$05,$00,$04,$05,$00,$04,$05,$00,$04,$05,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$06,$07,$00,$06,$07,$00,$06,$07,$00,$06,$07,$00
	.byte $06,$07,$00,$06,$07,$00,$06,$07,$00,$06,$07,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$34,$08,$09,$31,$08,$09,$31,$08,$09,$31,$08,$09,$31
	.byte $08,$09,$31,$08,$09,$00,$08,$09,$00,$08,$09,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$44,$45,$00,$41,$42,$00,$41,$42,$00,$41,$42,$00,$00
	.byte $42,$00,$00,$00,$00,$00,$42,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$04,$05,$00,$04,$05,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$06,$07,$00,$06,$07,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00

background3:
	.byte $00,$00,$12,$00,$00,$00,$00,$08,$09,$00,$08,$09,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$12,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$13,$00,$00
	.byte $00,$00,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11
	.byte $11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$11,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $25,$14,$24,$28,$18,$1f,$00,$2c,$00,$1a,$14,$15,$25,$1c,$18,$1f
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
	.byte $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00




.segment "CHR"
.incbin "background_cards2.chr" ;cambiar con todo los sprites correctos
